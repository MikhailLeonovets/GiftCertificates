<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Build from Jenkisn</title>
    <style type="text/css">
        /*base css*/
        a{color:#4a72af}
        body{background-color:#e4e4e4}
        body,p{margin:0;padding:0}
        img{display:block}
        h1,h2,h3,h4,h5,h6{margin:0 0 .8em 0}
        h3{font-size:28px;color:#444!important;font-family:Arial,Helvetica,sans-serif}
        h4{font-size:22px;color:#4a72af!important;font-family:Arial,Helvetica,sans-serif}
        h5{font-size:18px;color:#444!important;font-family:Arial,Helvetica,sans-serif}
        p{font-size:12px;color:#444!important;font-family:"Lucida Grande","Lucida Sans","Lucida Sans Unicode",sans-serif;line-height:1.5}
        ol li img{display:inline;height:20px}
        /*div styles*/
        /*.news{text-align:center;padding-top:15px;}*/
        .content{width:720px;background-color:white;margin-left: auto; margin-right: auto ;}
        .round_border{margin-bottom:5px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;margin-top:0;font-size:14px;padding:6px;border:1px solid #ccc}
        .status{background-color:green;font-size:28px;font-weight:bold;color:white;width:720px;height:52px;margin-bottom:18px;text-align:center;vertical-align:middle;border-collapse:collapse;background-repeat:no-repeat}
        .status .info{color:white!important;text-shadow:0 -1px 0 rgba(0,0,0,0.3);font-size:32px;line-height:36px;padding:8px 0}
        .main img{width:38px;margin-right:16px;height:38px}
        .main table{font-size:14px;}
        .main table th{text-align:left;}
        .bottom-message{width:720px;cellpadding:5px;cellspacing:0px}
        .bottom-message .message{font-size:13px;color:#aaa;line-height:18px;text-align:center}
        .bottom-message .designed{font-size:13px;color:#aaa;line-height:18px;font-style: italic;text-align:right}
        img.cartoon {width: 36px; display:inline}
    </style>
</head>
<body>
<!-- news -->
<div class="content round_border">
    <div class="status">
        <p class="info">The build ${build.result ?: 'completed'}</p>
    </div>
    <%
    import hudson.tasks.junit.TestResultAction
    //import hudson.tasks.test.AbstractTestResultAction
    //AbstractTestResultAction result = build.getAction(AbstractTestResultAction.class)
    TestResultAction testResultAction = build.getAction(TestResultAction.class)
    def total = " "
    def passed = " "
    def failed = " "
    def skipped = " "
    //if(result != null){
    //	passed = testResultAction.totalCount
    //}
    if(testResultAction){
    total = testResultAction.totalCount
    failed = testResultAction.failCount
    skipped = testResultAction.skipCount
    passed = total - failed - skipped  }
    %>
    <!-- status -->
    <div class="main round_border">
        <table>
            <tbody>
            <tr>
                <th>Project:</th>
                <td>${project.name}</td>
            </tr>
            <tr>
                <th>Build #${build.number}:</th>
                <td><A href="${rooturl}${build.url}">${rooturl}${build.url}</A></td>
            </tr>
            <tr>
                <th>Date of build:</th>
                <td>${it.timestampString}</td>
            </tr>
            <tr>
                <th>Build duration:</th>
                <td>${build.durationString}</td>
            </tr>
            <tr>
                <th>Build cause:</th>
                <td><% build.causes.each() { cause -> %> ${cause.shortDescription} <%  } %></td>
            </tr>
            <tr>
                <th>Test results:</th>
                <td>Total: ${total}; Passed:${passed}; Failed:${failed}; Skipped:${skipped}</td>
            </tr>
            <!--<tr>
                <td colspan="2">&nbsp;</td>
            </tr>-->
            </tbody>

        </table>

    </div>
    <!-- main -->
    <div class="artifacts round_border">
        <b>Report Artifacts:</b>
        <ul>
            <li><A href="${rooturl}${build.url}cucumber-html-reports/overview-features.html">${rooturl}${build.url}cucumber-html-reports/overview-features.html</A></li>
            <li><a href="#">display in new page</a></li>
        </ul>
    </div>
</div>
<!-- content -->

<table class="bottom-message" align="center">
    <tr>
        <td class="message">You are receiving this email because you
            are relavent with this build<br>
            <p>
                <a href="#">support team</a> | <a href="#">QA</a>
            </p>
        </td>
    </tr>
</table>
<!-- bottom message -->
</body>
</html>
